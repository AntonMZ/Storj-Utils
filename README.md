.# Storj-Utils

Скрипт проверки основных параметров работы нод Storjshare-Cli для Linux.<br/>

![Storj bash health script](http://maxrival.com/content/images/2017/05/storj-bash-healt-script-v1.0.2.png)

Скрипт работает на CentOS Linux release 7.0.1406 (Core)<br/>
На других платформах не проверялся.
<hr>

Для корректной работы скрипта требуется утилита netstat из пакета net-tools.<br/>
Для установки пакета:

```
yum install net-tools.x86_64 -y
```

Установка

```
wget -O health.sh https://raw.githubusercontent.com/AntonMZ/Storj-Utils/master/health.sh
```
<hr>

**Hostname** - hostname сервера где размещаются ноды<br/>
**Ip** - ip адреса сервера где размещаются ноды<br/>
**Date** - локальное время сервера где размещаются ноды<br/>
**Open Sessions** - количество открытых storjshare-cli tcp сессий<br/>
**Storjshare Version** - версия демона, ядра и протокола, используемого storjshare-cli

<hr>

- [**NodeID**] - уникальный идентификатор ноды.<br/>
Данные берутся из **storjshare status**

<hr>

- [**ResponseTime**] - показатель разницы между publish и offer.<br/>
Является показателем стабильности работы ноды, влияет на получение новых контрактов.<br/>
Выставляется непосредственно бриджем.<br/>
Чем ниже, тем больше шансов получить новые контракты.<br/>
Уменьшается со временем.<br/>
Чем стабильнее работает нода, тем меньше данный показатель.<br/>
Данный параметр является одним из главных, который проверяет бридж при загрузке нового контракта в сеть.<br/>
По данному параметру бридж сортирует список нод.<br/>
Данные берутся с api.storj.io

 Cтатусы<br/>
 **good** - в пределах нормы<br/>
 **bad** - не в пределах нормы

 *Для Москвы нормой считается значение данного показателя до 1000*<br/>
    
 Выставляется непосредственно бриджем.<br/>
 Данные берутся с api.storj.io

<hr>

- [**Address**] - текущий IP адрес ноды.<br/>
Данные берутся локально с сервера ноды.<br/>

<hr>

- [**User Agent**] - версия агента на ноде.<br/>

 Данные берутся с api.storj.io<br/>

<hr>

- [**Last Seen**] - последнее время появления ноды в сети.

 Последнее появление ноды в сети зафиксированное бриджем.<br/>
Данные берутся с api.storj.io<br/>

<hr>

- [**Port**] - порт ноды<br/>
Данные берутся с api.storj.io<br/>

 При запуску скрипта осуществляется проверка порта на ***открыт/закрыт*** через внешний api ресурс.
    
 Cтатусы<br/>
 **open** - порт открыт<br/>
 **close** - порт закрыт<br/>
 **filtered** - порт открыт, но используется через роутер или фаервол

 Порт может быть закрыт по многим причинам.
    
 Самые распространенные:
 
 * порт закрыт брандмауэром Windows или iptables
 * порт не "проброшен" в роутере/маршрутизаторе

<hr>

- [**Protocol**] - версия протокола storjshare-cli<br/>
Данные берутся с api.storj.io<br/>

<hr>

- [**Last Timeout**] - последнее замеченное время недоступности ноды<br/>
Влияет на получение новых контрактов.<br/>
Данные берутся с api.storj.io

<hr>

- [**Timeout Rate**] - коэффициент бриджа между lastseen и lastimeout<br/>
Влияет на получение новых контрактов.<br/>
Если данный параметр выше нуля, то получение новых контрактов будет затруднительно (не принимается offer)<br/>
Данные берутся с api.storj.io

 Cтатусы<br/>
 **good** - значение равно 0<br/>
 **bad** - значение отличное от 0

<hr>

- [**DeltaTime**] - временная дельта<br/>
Параметр показывает разницу локального времени и времени эталонного NTP сервера.<br/>
Параметр передается непосредственно бриджем сети.<br/>

 Cтатусы<br/>
    
 **bad** - значение больше 500 или -500<br/>
 **medium** - значение больше 100 или -100<br/>
 **good** - значение меньше 100 или -100


<hr>
Полная инструкция по работе со скриптом на сайте <a href="http://maxrival.com/ispolzovaniie-health-skripta-dlia-provierki-storj-nod/" target="_blank">maxrival.com</a>
